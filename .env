# ========================
# Database Configuration
# ========================
DB_TYPE="mariadb"
DB_HOST="localhost"
DB_PORT="3306"
DB_NAME="nextcloud"
DB_USER="nextcloud"
DB_PASS="$(openssl rand -base64 32)"
DB_ROOT_PASS="$(openssl rand -base64 32)"
DB_PREFIX="oc_"
DB_CHARSET="utf8mb4"
DB_COLLATION="utf8mb4_general_ci"

# ========================
# Nextcloud Configuration
# ========================
NEXTCLOUD_URL="https://cloud.e-granary.com"  # Change to your domain or server IP
NEXTCLOUD_ROOT="/var/www/nextcloud"
NEXTCLOUD_DATA_DIR="/var/nextcloud/data"
NEXTCLOUD_ADMIN_USER="admin"
NEXTCLOUD_ADMIN_PASS="$(openssl rand -base64 16)"  # Will be generated
NEXTCLOUD_TRUSTED_DOMAINS="cloud.e-granary.com"  # Add your domain(s), space-separated
NEXTCLOUD_OVERWRITE_PROTOCOL="https"
NEXTCLOUD_OVERWRITE_HOST="cloud.e-granary.com"
NEXTCLOUD_OVERWRITE_WEBROOT="/"
NEXTCLOUD_DEFAULT_PHONE_REGION="US"
NEXTCLOUD_MAINTENANCE_MODE="false"

# ========================
# PHP Configuration
# ========================
PHP_MEMORY_LIMIT="512M"
PHP_UPLOAD_LIMIT="10G"
PHP_POST_MAX_SIZE="10G"
PHP_UPLOAD_MAX_FILESIZE="10G"
PHP_MAX_EXECUTION_TIME="3600"
PHP_MAX_INPUT_TIME="3600"
PHP_DATE_TIMEZONE="Africa/Nairobi"
PHP_OPCACHE_ENABLE=1
PHP_OPCACHE_MEMORY_CONSUMPTION=128
PHP_OPCACHE_INTERNED_STRINGS_BUFFER=16

# ========================
# Redis Configuration
# ========================
REDIS_ENABLED="true"
REDIS_HOST="localhost"
REDIS_PORT="6379"
REDIS_PASSWORD="$(openssl rand -base64 32)"  # Will be generated
REDIS_DB_INDEX="1"
REDIS_TIMEOUT="1.5"
REDIS_READ_TIMEOUT="1.5"
REDIS_RETRY_TIMEOUT="16"
REDIS_CACHE_TTL="6"

# ========================
# Backup Configuration
# ========================
BACKUP_ENABLED="true"
BACKUP_DIR="/var/backups/nextcloud"
BACKUP_RETENTION_DAYS="30"
BACKUP_COMPRESSION="zstd"
BACKUP_ENCRYPTION="true"
BACKUP_ENCRYPTION_KEY="$(openssl rand -base64 32)"  # Will be generated
BACKUP_TIME="02:00"  # Daily backup at 2 AM

# ========================
# Cloudflare R2 Configuration (Optional)
# ========================
R2_ENABLED="false"
R2_ACCESS_KEY="bf0224ba3802349c76f6f627aeb299bb"
R2_SECRET_KEY="4002626c9d8a8c8c5dfeef3918b06ff662253174c54f21cbc5e1bf87d8ea010c"
R2_BUCKET="nextcloud-backups"
R2_ENDPOINT="https://42cbf5797f0c36b80b1b62e20c484993.r2.cloudflarestorage.com"
R2_REGION="auto"
R2_USE_PATH_STYLE="false"

# ========================
# Email Configuration
# ========================
MAIL_SMTP_DEBUG=0
MAIL_SMTP_AUTOTLS=true
MAIL_SMTP_AUTH=true
MAIL_SMTP_SECURE="tls"
MAIL_SMTP_HOST="sandbox.smtp.mailtrap.io"
MAIL_SMTP_PORT=2525
MAIL_SMTP_USERNAME="be6e87f82be3a7"
MAIL_SMTP_PASSWORD="2b1dadf3db173f"
MAIL_FROM_ADDRESS="support@e-granary.com"
MAIL_DOMAIN="cloud.e-granary.com"

# ========================
# System Configuration
# ========================
TIMEZONE="Africa/Nairobi"
LOCALE="en_US.UTF-8"
CRON_PERIOD="15mins"
CRON_MEMORY_LIMIT=512
CRON_OUTPUT="/dev/null"

# ========================
# Security Configuration
# ========================
TRUSTED_PROXIES=""
FORWARDED_FOR_HEADER=""
OVERWRITE_HOST=""
OVERWRITE_PROTOCOL=""
OVERWRITE_WEBROOT=""
HTTPS_ENABLED="true"
STRICT_TRANSPORT_SECURITY="true"

# ========================
# Setup & Management Logging
# ========================
# Log levels: 0=Debug, 1=Info, 2=Warning, 3=Error
LOG_LEVEL="1"  # Default to INFO level

# Log file paths (relative to project root)
LOG_DIR="${PROJECT_ROOT:-.}/logs"
LOG_FILE="${LOG_DIR}/setup-$(date +%Y%m%d).log"
LOG_ERROR_FILE="${LOG_DIR}/error-$(date +%Y%m%d).log"

# Log rotation settings (handled by logrotate)
LOG_ROTATION_DAYS=30
LOG_MAX_SIZE="10M"

# Timezone for log timestamps
LOG_TIMEZONE="Africa/Nairobi"

# Disable application logging (handled by Nextcloud's own logging)
NEXTCLOUD_LOG_TYPE="errorlog"  # Use PHP error log instead of file
NEXTCLOUD_LOG_LEVEL="2"  # Warning level
NEXTCLOUD_LOG_FILE=""  # Don't use file logging

# ========================
# Performance Configuration
# ========================
APC_ENABLED="1"
APC_TTL="3600"
APC_GC_TTL="3600"
OPCACHE_ENABLE="1"
OPCACHE_VALIDATE_TIMESTAMPS="0"
OPCACHE_REVALIDATE_FREQ="2"

# ========================
# Preview Configuration
# ========================
ENABLE_PREVIEWS="true"
PREVIEW_MAX_X=2048
PREVIEW_MAX_Y=2048
PREVIEW_MAX_SCALE_FACTOR=1
PREVIEW_MAX_FILESIZE_IMAGE=50

# ========================
# Maintenance Configuration
# ========================
MAINTENANCE_WINDOW_START=1  # 1 AM
MAINTENANCE_WINDOW_END=4    # 4 AM
